LONGUEUR_CORRELATION <- scan("../longueur_correlation_vraie.txt")

NOM_VRAI <- "True parameters"
NOM_MLE <- "MLE"
NOM_MAP <- "MAP"
NOM_BAYESIEN <- "Full posterior dist."
NOM_BARYESIEN_APPROX <- NULL
TITRE_GRAPHE <- paste("PDF of Predictive Interval accuracy:", "\n", LONGUEUR_CORRELATION[1], "-", LONGUEUR_CORRELATION[2], "-", LONGUEUR_CORRELATION[3])
LEGENDE_ABSCISSES <- "Accuracy rate"
LEGENDE_ORDONNEES <- "Probability density"

Frequences_appartient_intervalle_pari <- read.table("matrice_frequences_appartient_intervalle_pari.txt", as.is = TRUE)
    
Frequences_appartient_intervalle_pari_VRAI <- density(Frequences_appartient_intervalle_pari[,1])
Frequences_appartient_intervalle_pari_MLE <- density(Frequences_appartient_intervalle_pari[,2])
Frequences_appartient_intervalle_pari_MAP <- density(Frequences_appartient_intervalle_pari[,3])
Frequences_appartient_intervalle_pari_BAYES <- density(Frequences_appartient_intervalle_pari[,4])

Max_densite <- max(Frequences_appartient_intervalle_pari_VRAI$y, Frequences_appartient_intervalle_pari_MLE$y, Frequences_appartient_intervalle_pari_MAP$y, Frequences_appartient_intervalle_pari_BAYES$y)



 
plot(x=c(min(Frequences_appartient_intervalle_pari),max(Frequences_appartient_intervalle_pari)),y=c(0,Max_densite), type="n", main=TITRE_GRAPHE, xlab=LEGENDE_ABSCISSES, ylab=LEGENDE_ORDONNEES)
#abscisses <- 1/nrow(Frequences_appartient_intervalle_pari) * 1:nrow(Frequences_appartient_intervalle_pari)
#smooth <- loess( Frequences_appartient_intervalle_pari_VRAI ~ abscisses)
lines(Frequences_appartient_intervalle_pari_VRAI, lwd=2)
    lines(Frequences_appartient_intervalle_pari_MLE ,col=3, lwd=2, lty=2)
    lines(Frequences_appartient_intervalle_pari_MAP ,col=2, lwd=2, lty=4)
    lines(Frequences_appartient_intervalle_pari_BAYES, col=4, lwd=2, lty=3)
    #lines(abscisses, Frequences_appartient_intervalle_pari_BAYES_APPROX, col=4, lty=3, lwd=1)
legende <- c(NOM_VRAI,NOM_MLE,NOM_MAP,NOM_BAYESIEN)
lwd <- c(2,2,2,2)
lty <- c(1,2,4,3)
col <- c(1,3,2,4)
legend("topleft", legende, lty=lty, col=col)
dev.copy(pdf,"Densite_appartient_intervalle_pari.pdf")
dev.off()






