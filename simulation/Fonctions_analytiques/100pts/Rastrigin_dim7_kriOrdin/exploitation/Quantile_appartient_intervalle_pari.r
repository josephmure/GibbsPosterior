NOM_MLE <- "MLE"
NOM_MAP <- "MAP"
NOM_BAYESIEN <- "Full posterior dist."
NOM_BARYESIEN_APPROX <- NULL
TITRE_GRAPHE <- paste("Quantile function of Predictive Interval accuracy in Ordinary Kriging: 7-dimensional Rastrigin function")
LEGENDE_ABSCISSES <- "Cumulative probability"
LEGENDE_ORDONNEES <- "Accuracy rate"

Frequences_appartient_intervalle_pari <- read.table("matrice_frequences_appartient_intervalle_pari.txt", as.is = TRUE)
    

Frequences_appartient_intervalle_pari_MLE <- sort(Frequences_appartient_intervalle_pari[,1],decreasing=FALSE)
Frequences_appartient_intervalle_pari_MAP <- sort(Frequences_appartient_intervalle_pari[,2],decreasing=FALSE)
Frequences_appartient_intervalle_pari_BAYES <- sort(Frequences_appartient_intervalle_pari[,3],decreasing=FALSE)

print(c(mean(Frequences_appartient_intervalle_pari_MLE),mean(Frequences_appartient_intervalle_pari_MAP), mean(Frequences_appartient_intervalle_pari_BAYES)))

##Creation du plot : fonction de répartition du taux d'appartenance (pour une réalisation donnée du processus) à l'intervalle de pari pour chaque méthode

library(vioplot)
vioplot(Frequences_appartient_intervalle_pari_MLE, Frequences_appartient_intervalle_pari_MAP,Frequences_appartient_intervalle_pari_BAYES,  names=c("MLE", "MAP", "FPD"),col="gold", h=0.03, ylim=c(0.5,1))

dev.copy(pdf,"Violon_appartient_intervalle_pari.pdf")
dev.off()
 
plot(x=c(0,1),y=c(0.8,1), type="n", main=TITRE_GRAPHE, xlab=LEGENDE_ABSCISSES, ylab=LEGENDE_ORDONNEES)
abscisses <- 1/nrow(Frequences_appartient_intervalle_pari) * 1:nrow(Frequences_appartient_intervalle_pari)
#smooth <- loess( Frequences_appartient_intervalle_pari_VRAI ~ abscisses)
    lines(abscisses, predict(loess(Frequences_appartient_intervalle_pari_MLE ~ abscisses)) ,col=3, lwd=2, lty=2)
    lines(abscisses, predict(loess(Frequences_appartient_intervalle_pari_MAP ~ abscisses)) ,col=2, lwd=2, lty=4)
    lines(abscisses, predict(loess(Frequences_appartient_intervalle_pari_BAYES ~ abscisses)), col=4, lwd=2, lty=3)
    #lines(abscisses, Frequences_appartient_intervalle_pari_BAYES_APPROX, col=4, lty=3, lwd=1)
legende <- c(NOM_MLE,NOM_MAP,NOM_BAYESIEN)
lwd <- c(2,2,2)
lty <- c(2,4,3)
col <- c(3,2,4)
legend("bottomright", legende, lty=lty, col=col)
dev.copy(pdf,"Quantile_appartient_intervalle_pari.pdf")
dev.off()






