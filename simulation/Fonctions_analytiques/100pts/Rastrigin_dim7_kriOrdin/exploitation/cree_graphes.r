## Recuperation des resultats

observations <- scan("observations.txt")

Valeurs_nouveaux_points <- as.matrix(read.csv("Ensemble_test_valeurs.csv"))[,2]

Prediction_argmax_vraisemblance <- as.matrix(read.csv("Prediction_argmax_vraisemblance.csv"))[,2]
Appartient_intervalle_pari_argmax_vraisemblance <- as.matrix(read.csv("Appartient_intervalle_pari_argmax_vraisemblance.csv"))[,2]

Prediction_mode_posterior <- as.matrix(read.csv("Prediction_mode_posterior.csv"))[,2]
Appartient_intervalle_pari_mode_posterior <- as.matrix(read.csv("Appartient_intervalle_pari_mode_posterior.csv"))[,2]

Moyennes_conditionnelles_bayesiennes <- as.matrix(read.csv("Moyennes_conditionnelles_bayesiennes.csv"))[,2]
Appartient_intervalle_pari_full_bayesien_exact <- as.matrix(read.csv("Appartient_intervalle_pari_bayesien.csv"))[,2]
Appartient_intervalle_pari_full_bayesien <- as.matrix(read.csv("Appartient_intervalle_pari_bayesien_approx.csv"))[,2]

## Graphes

plotMIN <- min(Valeurs_nouveaux_points)
plotMAX <- max(Valeurs_nouveaux_points)

plot(Valeurs_nouveaux_points[Appartient_intervalle_pari_argmax_vraisemblance==1], Prediction_argmax_vraisemblance[Appartient_intervalle_pari_argmax_vraisemblance==1], pch=4, xlim=c(plotMIN,plotMAX), ylim=c(plotMIN,plotMAX), xlab="Values at test points", ylab= "Prediction (MLE)", col=4)

points(Valeurs_nouveaux_points[Appartient_intervalle_pari_argmax_vraisemblance==0], Prediction_argmax_vraisemblance[Appartient_intervalle_pari_argmax_vraisemblance==0], pch=4, col=2)

lines(c(plotMIN,plotMAX), c(plotMIN,plotMAX), lwd=3)
points(observations, observations, col=3)

dev.copy(pdf,"perfMLE.pdf")
dev.off()


plot(Valeurs_nouveaux_points[Appartient_intervalle_pari_mode_posterior==1], Prediction_mode_posterior[Appartient_intervalle_pari_mode_posterior==1], pch=4, xlim=c(plotMIN,plotMAX), ylim=c(plotMIN,plotMAX), xlab="Values at test points", ylab= "Prediction (MAP)", col=4)

points(Valeurs_nouveaux_points[Appartient_intervalle_pari_mode_posterior==0], Prediction_mode_posterior[Appartient_intervalle_pari_mode_posterior==0], pch=4, col=2)

lines(c(plotMIN,plotMAX), c(plotMIN,plotMAX), lwd=3)
points(observations, observations, col=3)

dev.copy(pdf,"perfMAP.pdf")
dev.off()


plot(Valeurs_nouveaux_points[Appartient_intervalle_pari_full_bayesien_exact==1], Moyennes_conditionnelles_bayesiennes[Appartient_intervalle_pari_full_bayesien_exact==1], pch=4, xlim=c(plotMIN,plotMAX), ylim=c(plotMIN,plotMAX), xlab="Values at test points", ylab= "Prediction (FPD)", col=4)

points(Valeurs_nouveaux_points[Appartient_intervalle_pari_full_bayesien_exact==0], Moyennes_conditionnelles_bayesiennes[Appartient_intervalle_pari_full_bayesien_exact==0], pch=4, col=2)

lines(c(plotMIN,plotMAX), c(plotMIN,plotMAX), lwd=3)
points(observations, observations, col=3)

dev.copy(pdf,"perfFPD.pdf")
dev.off()


plot(Valeurs_nouveaux_points[Appartient_intervalle_pari_full_bayesien==1], Moyennes_conditionnelles_bayesiennes[Appartient_intervalle_pari_full_bayesien==1], pch=4, xlim=c(plotMIN,plotMAX), ylim=c(plotMIN,plotMAX), xlab="Values at test points", ylab= "Prediction (approximate FPD)", col=4)

points(Valeurs_nouveaux_points[Appartient_intervalle_pari_full_bayesien==0], Moyennes_conditionnelles_bayesiennes[Appartient_intervalle_pari_full_bayesien==0], pch=4, col=2)

lines(c(plotMIN,plotMAX), c(plotMIN,plotMAX), lwd=3)
points(observations, observations, col=3)

dev.copy(pdf,"perfFPDapprox.pdf")
dev.off()


